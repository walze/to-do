FROM node:14

ARG NODE_ENV
ARG SCRIPT

ENV NODE_ENV ${NODE_ENV}
ENV SCRIPT ${SCRIPT}

WORKDIR /app

COPY . .

RUN npm i
RUN npm run gen
RUN npx prisma generate

EXPOSE 4000

CMD npm run ${SCRIPT} --NODE_ENV=${NODE_ENV}